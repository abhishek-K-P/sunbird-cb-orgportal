<form [formGroup]="eventDetails" class="event-details p-6 flex flex-column gap-5"
  [ngClass]="{'disableForm': openMode === 'view'}">
  <div class="event-header">
    Basic Details
  </div>

  <ng-container *ngIf="appIconName; else uploadIcon">
    <div class="appIconCard flex justify-between px-2 items-center">
      <div class="flex gap-2 items-center">
        <img src="/assets/icons/image.svg" alt="app icon">
        <span class="iconName">{{appIconName}}</span>
      </div>
      <ng-container *ngIf="openMode === 'edit'">
        <mat-icon class="remove-app-icon" (click)="removeFile('appIcon')">close</mat-icon>
      </ng-container>
    </div>
  </ng-container>
  <ng-template #uploadIcon>
    <div class="upload flex justify-center items-center cursor-pointer dashed-border"
      [ngClass]="{'disable': openMode === 'view'}" onclick="document.getElementById('upload-file').click();">
      <input #file type="file" name="upload-file" id="upload-file" class="hidden" accept=".png, .jpg, .jpeg"
        (change)="onFileSelected(file.files);">
      <div class="flex flex-column items-center gap-2">
        <img src="/assets/icons/upload-upward-arrow.svg" alt="icon">
        <span class="text-sm font-bold text-blue">Upload Image <strong class="text-red-700">*</strong></span>
        <span class="text-xs font-normal">Supported file types: PNG, JPG</span>
        <span class="text-xs font-normal">Max Size - 400MB</span>
      </div>
    </div>
  </ng-template>

  <div class="flex flex-column gap-2 event-form disable-round">
    <div class="form-lable required">
      Event Name
    </div>
    <mat-form-field appearance="outline" class="">
      <input matInput placeholder="Add your event name" formControlName="eventName" maxlength="70">
      <mat-error *ngIf="showValidationMsg('eventName','required')">
        Event name is mandatory
      </mat-error>
      <mat-error *ngIf="showValidationMsg('eventName','pattern')">
        Only ( a-z/A-Z , 0-9 . _ - $ / : [ ]' ' !) characters are supported
      </mat-error>
      <mat-error *ngIf="!showValidationMsg('eventName','pattern')
        && showValidationMsg('eventName','minlength')">
        Minimum characters left to create {{ 10 - eventDetails?.controls['eventName'].value.length}}
      </mat-error>
    </mat-form-field>
  </div>

  <div class="flex flex-column gap-2">
    <div class="form-lable required">
      Description
    </div>
    <mat-form-field appearance="outline" class="">
      <textarea matInput placeholder="Add your description" formControlName="description" maxlength="500"> </textarea>
      <mat-error *ngIf="showValidationMsg('description','required')">
        Description is mandatory
      </mat-error>
      <mat-error *ngIf="showValidationMsg('description','minlength')">
        Minimum characters left to create {{ 250 - eventDetails?.controls['description'].value.length}}
      </mat-error>
    </mat-form-field>
    <span class="description-count flex justify-end">{{eventDetails?.value?.description?.length}}/500</span>
  </div>

  <ng-container *ngIf="uploadedVideoName; else uploadVideo">
    <div class="appIconCard flex justify-between px-2 items-center">
      <div class="flex gap-2 items-center">
        <img src="/assets/icons/image.svg" alt="app icon">
        <span class="iconName">{{uploadedVideoName}}</span>
      </div>
      <ng-container *ngIf="openMode === 'edit'">
        <mat-icon class="remove-app-icon" (click)="removeFile('uploadedVideo')">close</mat-icon>
      </ng-container>
    </div>
  </ng-container>
  <ng-template #uploadVideo>
    <div class="upload flex justify-center items-center cursor-pointer dashed-border"
      [ngClass]="{'disable': openMode === 'view' || disableUpload }" cdkDropList [cdkDropListData]="videoData"
      (cdkDropListDropped)="onVideoSelected($event)" (dragover)="preventDefaultCDK($event)"
      (dragenter)="preventDefaultCDK($event, 'enter')" (dragleave)="preventDefaultCDK($event, 'leave')"
      (drop)="onDrop($event)" onclick="document.getElementById('upload-video').click();">
      <input #file type="file" name="upload-video" id="upload-video" class="hidden"
        accept="video/mp4, video/mov, video/avi" (change)="onVideoSelected(file.files);">
      <div class="flex flex-column items-center gap-2">
        <img src="/assets/icons/upload-upward-arrow.svg" alt="icon">
        <span class="text-sm font-bold text-blue">Select video to upload <strong class="text-red-700">*</strong></span>
        <span class="text-xs font-normal">or drag and drop here</span>
        <span class="text-xs font-normal">Max Size - 400MB</span>
      </div>
    </div>
  </ng-template>
  <div class="flex flex-column gap-2 event-form w-full " [ngClass]="{'disableForm': disableUrl}">
    <div class="form-url-lable required">
      or upload from URL
    </div>
    <mat-form-field appearance="outline" class="disable-round">
      <input matInput placeholder="Enter url" formControlName="registrationLink">
      <mat-error *ngIf="showValidationMsg('registrationLink','required')">
        Resource is mandatory
      </mat-error>
      <mat-error *ngIf="showValidationMsg('registrationLink','pattern')">
        Please give valid URL
      </mat-error>
    </mat-form-field>
  </div>

  <div class="flex flex-row gap-4">
    <div class="flex flex-column gap-2 event-form w-full disable-round">
      <div class="form-lable required">
        Event Category
      </div>
      <mat-form-field appearance="outline" class="">
        <mat-select placeholder="select Event Category" formControlName="eventCategory">
          <ng-container *ngFor="let category of evntCategorysList">
            <mat-option [value]="category">
              {{category}}
            </mat-option>
          </ng-container>
        </mat-select>
        <mat-error *ngIf="showValidationMsg('eventCategory','required')">
          Event category is mandatory
        </mat-error>
      </mat-form-field>
    </div>
    <!-- <div class="flex flex-column gap-2 event-form w-full disable-round">
      <div class="form-lable required">
        Stream Type
      </div>
      <mat-form-field appearance="outline" class="">
        <mat-select placeholder="select Event Category" formControlName="streamType">
          <mat-option>
          </mat-option>
        </mat-select>
        <mat-error *ngIf="showValidationMsg('streamType','required')">
          stream type is mandatory
        </mat-error>
      </mat-form-field>
    </div> -->
  </div>

  <div class="flex flex-row gap-4">
    <div class="flex flex-column gap-2 event-form w-full disable-round eventTimpicker">
      <div class="form-lable required">
        Date
      </div>
      <mat-form-field appearance="outline" class="">
        <input matInput [matDatepicker]="startDate" [min]="todayDate" placeholder="Enter Start Date"
          formControlName="startDate">
        <mat-datepicker-toggle matSuffix [for]="startDate"></mat-datepicker-toggle>
        <mat-datepicker #startDate></mat-datepicker>
        <mat-error *ngIf="showValidationMsg('startDate','required')">
          Date is mandatory
        </mat-error>
      </mat-form-field>
    </div>
    <div class="flex flex-column gap-2 event-form w-full disable-round">
      <div class="form-lable required">
        Start Time
      </div>
      <mat-form-field appearance="outline">
        <input matInput placeholder="Enter Start Time" formControlName="startTime" [ngxTimepicker]="startTimepicker"
          [max]="maxTimeToStart" readonly>
        <ngx-material-timepicker-toggle [for]="startTimepicker" matSuffix></ngx-material-timepicker-toggle>
        <ngx-material-timepicker #startTimepicker (change)="onStartTimeChange($event)" class="eventTimpicker"
          [enableKeyboardInput]="true"></ngx-material-timepicker>
        <mat-error *ngIf="showValidationMsg('startTime','required')">
          Start time is mandatory
        </mat-error>
      </mat-form-field>
    </div>
    <div class="flex flex-column gap-2 event-form w-full disable-round">
      <div class="form-lable required">
        End Time
      </div>
      <mat-form-field appearance="outline" class="">
        <input matInput placeholder="Enter End Time" formControlName="endTime" [ngxTimepicker]="endTimepicker"
          [min]="minTimeToEnd" readonly>
        <ngx-material-timepicker-toggle [for]="endTimepicker" matSuffix></ngx-material-timepicker-toggle>
        <ngx-material-timepicker #endTimepicker (change)="onEndTimeChange($event)"
          [enableKeyboardInput]="true"></ngx-material-timepicker>
        <mat-error *ngIf="showValidationMsg('endTime','required')">
          End time is mandatory
        </mat-error>
      </mat-form-field>
    </div>
  </div>

</form>