<div class="self-registration-wrapper">
  <div class="flex">

    <ng-container>
      <ng-container *ngIf="!isLoading">
        <div class="w-1/2 p-6 relative form-wrapper">
          <ng-container *ngIf="!framewordId || this.designationsList?.length === 0">
            <img src="/assets/icons/bg-blur-self-registration.png" alt="icon" class="w-full">
            <div class="nodata absolute inset-0 flex items-center justify-center">
              <div class="flex flex-column items-center justify-center">
                <img src="/assets/icons/empty_data.svg" alt="icon" class="mx-auto">
                <span class="font-bold text-sm my-4 block">No designation has been imported from iGOT master.</span>
                <button mat-flat-button class="mat-btn-outline" (click)="startImporting()">Start
                  Importing</button>
              </div>
            </div>
          </ng-container>
          <ng-container *ngIf="framewordId && this.designationsList?.length > 0">
            <form [formGroup]="selfRegistrationForm">
              <div class="create-registration-link">
                <div class="flex gap-2 mb-8">
                  <ng-container *ngIf="customRegistrationLinks?.registrationLink">
                    <span class="font-semibold fw-montserrat text-lg">Link Status -</span>
                    <div class="badge flex items-center"
                      [ngClass]="latestRegisteredData?.status && latestRegisteredData?.status === 'active' ? 'active':'in-active'">
                      {{latestRegisteredData?.status && latestRegisteredData?.status === 'active' ?
                      'Active': 'Inactive'}}</div>
                  </ng-container>
                </div>

                <div class="flex flex-column gap-1 w-full mat-field-rounded">
                  <div class="flex items-center gap-1 required">
                    <span class="lable">Start Date</span>
                  </div>
                  <mat-form-field appearance="outline">
                    <input matInput [matDatepicker]="startDate" [min]="todayDate" placeholder="Enter Start Date"
                      formControlName="startDate">
                    <mat-datepicker-toggle matSuffix [for]="startDate"></mat-datepicker-toggle>
                    <mat-datepicker #startDate></mat-datepicker>
                  </mat-form-field>
                </div>
                <div class="flex flex-column gap-1 w-full mat-field-rounded">
                  <div class="flex items-center gap-1 required">
                    <span class="lable">End Date</span>
                  </div>
                  <mat-form-field appearance="outline">
                    <input matInput [matDatepicker]="endDate" placeholder="Enter End Date" formControlName="endDate"
                      [min]="selfRegistrationForm.get('startDate')?.value">
                    <mat-datepicker-toggle matSuffix [for]="endDate"></mat-datepicker-toggle>
                    <mat-datepicker #endDate></mat-datepicker>
                  </mat-form-field>
                </div>
              </div>
              <div class="flex items-center justify-center mt-4">
                <ng-container *ngIf="!customRegistrationLinks">
                  <button mat-flat-button class="mat-btn-flat" (click)="generateRegistrationLink()"
                    [disabled]="selfRegistrationForm?.invalid">Generate Link</button>
                </ng-container>
                <ng-container *ngIf="customRegistrationLinks">
                  <button mat-flat-button class="mat-btn-outline" (click)="publishNewLink()"
                    [disabled]="selfRegistrationForm?.invalid">Publish New
                    Link</button>
                </ng-container>
              </div>
            </form>
          </ng-container>
        </div>
      </ng-container>

      <ng-container *ngIf="isLoading">
        <div class="flex items-center mx-auto">
          <mat-spinner [diameter]="30" [strokeWidth]="3"></mat-spinner>
        </div>
      </ng-container>
    </ng-container>

    <div class="w-1/2" [ngClass]="customRegistrationLinks ? 'px-4': 'p-4'">
      <ng-container *ngIf="!customRegistrationLinks">
        <img src="/assets/icons/bg-blur-self-registration-1.png" alt="icon">
      </ng-container>

      <ng-container *ngIf="customRegistrationLinks">
        <div class="link-generated">
          <div class="wrapper-card p-4 rounded-lg">
            <div class="flex justify-between">
              <div class="flex gap-3 items-center">
                <mat-icon class="mr-2">link</mat-icon>
                <a class="brand-color cursor-pointer underline bg-inherit text-sm break-word-link"
                  [href]="customRegistrationLinks?.registrationLink"
                  target="_blank">{{customRegistrationLinks?.registrationLink}}</a>
              </div>
            </div>

            <div class="actions-buttons flex gap-4 items-center mt-4 flex-wrap">
              <button mat-flat-button class="mat-btn-outline"
                (click)="copyLinkToClipboard(customRegistrationLinks?.registrationLink)">Copy Link</button>
              <button mat-flat-button class="mat-btn-outline"
                (click)="sendViaEmail(customRegistrationLinks?.registrationLink)">
                <mat-icon class="mr-2"> email</mat-icon>
                <span>Share on Mail</span>
              </button>

              <button mat-flat-button class="mat-btn-outline"
                (click)="sendViaWhatsApp(customRegistrationLinks?.registrationLink)">
                <img src="/assets/icons/whatsapp.svg" alt="icon" class="mr-2" width="24" height="24">
                <span>Share on Whatsapp</span>
              </button>
            </div>
          </div>

          <div class="wrapper-card py-4 px-12 rounded-lg mt-4">
            <div class="flex justify-between">
              <div class="qr-scanner-cont flex items-center">
                <img [src]="customRegistrationLinks?.qrRegistrationLogoPath" alt="qr-scanner" width="115" height="115">
              </div>
              <div class="flex flex-column items-center justify-center gap-2">
                <button mat-flat-button class="mat-btn-outline w-full"
                  (click)="downloadQRCode(customRegistrationLinks?.qrRegistrationLink)">Download
                  QR</button>
                <button mat-flat-button class="mat-btn-outline w-full"
                  (click)="sendViaEmail(customRegistrationLinks?.qrRegistrationLink);">
                  <mat-icon class="mr-2"> email</mat-icon>
                  <span>Share on Mail</span>
                </button>

                <button mat-flat-button class="mat-btn-outline w-full"
                  (click)="sendViaWhatsApp(customRegistrationLinks?.qrRegistrationLink)">
                  <img src="/assets/icons/whatsapp.svg" alt="icon" class="mr-2" width="24" height="24">
                  <span>Share on Whatsapp</span>
                </button>
              </div>
            </div>
          </div>

          <div class="wrapper-card p-4 rounded-lg mt-4">
            <div class="flex gap-4 items-center">
              <img src="/assets/icons/users.svg" alt="users" width="32" height="32">
              <span class="text-sm">Users Onboarded via Custom URL: <strong
                  class="ml-1">{{numberOfUsersOnboarded}}</strong></span>
            </div>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</div>